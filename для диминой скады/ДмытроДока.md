# Документация к светофору 
Это тестовое заадние, при поступлении в отдел ПО, здесть лежит проекты OWEN для SCADA (SimanticSystems)

проект предстваляет симуляцию светофоров перекрёстка, с возможностью подключения и работы в системе SCADA
на стороне МК используются входы
Переманная "mode", отвечающая за режим работы свотофора: 
	- mode = 0
		- Автономный режим. Светофор сам работает переключаясь с режима на режим через указанные промежутки времени
	- mode = 1
		- Управляемый режим. Светофор реагирует на команды переключения диспетчера, пока не пойдет команда на переключение или не изменится режим светофора он стабильно будет гореть в заданном переключении.
	- mode = 2
		- Нерегулируемый режим. Светофор не регулирует движение автомобилей перекрестка, признак нерегулиремого движения - интервальное мигание желтого света.
		(правильное переключение в нерегулируемый и из него предусмотрено).
### MODBUS подключения
Прибор умеет общаться по 2-х проводному протоколу RS-485, с подключением в общую шину MODBUS
**Данные для подключения**
В тестовом стенде, в качестве интерфейса использовалась MOXA Uport
***в пропиетарном конфигурторе, в диспетчере устройств необходимо выбрать корректный протокол подключения к прибору ПР***
  
  Получается постно но со вкусом, ибо (учитывая что мы берем степени 2 (1,2,4,8,16 и т.д.) мы можем побитово считать все флаги
  Получилось всего пара сетевых переменных
  ```
  дрянь в ответ (513 адрес регистра)- прием команд от SCADA
    дальше bool висят побитово на разных позициях
    1 красный сигнал первого светофора (1)
    2 желтый сигнал первого светофора (2)
    3 зеленый сигнал первого светофора (4)
    4 красный сигнал второго светофора (8)
    5 желтый сигнал второго светофора (16)
    6 зеленый сегнал второго светофора (32)
    7 isAuto - флаг состояния управления ( если автоматический - True) (64)
    8 lokx - флаг состояния блокировки
  red color timing (520) - склько будет гореть красный сигнал первого светофора и соответственно, склько будет гореть зелеёный второго
  green color timing (521)
  дрянь (512) упять упакованая переменная
    1 переключение управления (автоматичемский, ручной) десятичная 1
    2 включить моргающий желтый (только если в ручном режиме) десятичная 2
    3 в ручном режиме сменить сигналы светофоров десятичная 4