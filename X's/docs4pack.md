# Документация к светофору 
Это тестовое заадние, при поступлении в отдел ПО, здесть лежит проект OWEN + SCADA (SimanticSystems)

проект предстваляет симуляцию светофоров перекрёстка, с возможностью подключения и работы в системе SCADA
на стороне МК используются входы
I1 - Смена режима управления (индикация выведена на дискретный выход Q2)
I2 - Смена *сигнала* управления (только в ручном режиме)
I3 - Включение/выключение режима Maintance (моргающий желтый сигнал - индикация выведена на дискретный выход Q1)
### MODBUS подключения
Прибор умеет общаться по 2-х проводному протоколу RS-485, с подключением в общую шину MODBUS
**Данные для подключения**
В тестовом стенде, в качестве интерфейса использовалась MOXA Uport
***в пропиетарном конфигурторе, в диспетчере устройств необходимо выбрать корректный протокол подключения к прибору ПР***
  Начиная с 4-й попытки родить что-то нормальное, появилось новое требование - минимальный размер траффика между устройствами на RS-485.
  Это достигнуто довольно примитивным способом, на стороне мк все необходимые бинарные флаги сопоставлены с числами - степенями двойки.
  True? - добавляем в общую сумму энную величину если False - отнимаем.
  Получается постно но со вкусом, ибо (учитывая что мы берем степени 2 (1,2,4,8,16 и т.д.) мы можем побитово считать все флаги
  Получилось всего пара сетевых переменных
  ```
  дрянь в ответ (513 адрес регистра)- прием команд от SCADA
    дальше bool висят побитово на разных позициях
    1 красный сигнал первого светофора (1)
    2 желтый сигнал первого светофора (2)
    3 зеленый сигнал первого светофора (4)
    4 красный сигнал второго светофора (8)
    5 желтый сигнал второго светофора (16)
    6 зеленый сегнал второго светофора (32)
    7 isAuto - флаг состояния управления ( если автоматический - True) (64)
    8 lokx - флаг состояния блокировки
  red color timing (520) - склько будет гореть красный сигнал первого светофора и соответственно, склько будет гореть зелеёный второго
  green color timing (521)
  дрянь (512) упять упакованая переменная
    1 переключение управления (автоматичемский, ручной) десятичная 1
    2 включить моргающий желтый (только если в ручном режиме) десятичная 2
    3 в ручном режиме сменить сигналы светофоров десятичная 4
  leastTime - минимальное время которое можно установить для переключения светофоров
    ```
    
все переменные передаются в целочисленном формате, на высокой стороне преобразубся в bool при необходимости
