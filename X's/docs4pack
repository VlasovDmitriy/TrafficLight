# Документация к светофору 
Это тестовое заадние, при поступлении в отдел ПО, здесть лежит проект OWEN + SCADA (SimanticSystems)

проект предстваляет симуляцию светофоров перекрёстка, с возможностью подключения и работы в системе SCADA
на стороне МК используются входы
I1 - Смена режима управления (индикация выведена на дискретный выход Q2)
I2 - Смена *сигнала* управления (только в ручном режиме)
I3 - Включение/выключение режима Maintance (моргающий желтый сигнал - индикация выведена на дискретный выход Q1)
### MODBUS подключения
Прибор умеет общаться по 2-х проводному протоколу RS-485, с подключением в общую шину MODBUS
**Данные для подключения**
В тестовом стенде, в качестве интерфейса использовалась MOXA Uport
***в пропиетарном конфигурторе, в диспетчере устройств необходимо выбрать корректный протокол подключения к прибору ПР***
  Начиная с 4-й попытки родить что-то нормальное, появилось новое требование - минимальный размер траффика. между устройствами на RS-485
  Это достигнуто довольник примитивным способом, на стороне мк все необходимые бинарные флаги сопоставлены с числами - степенями двойки.
  True? добавляем в общую сумму энную величину если False - отнимаем
  Получается постно но со вкусом, ибо (учитывая что мы берем степени 2 (1,2,4,8,16 и т.д.) мы можем побитово считать все флаги
  Получилось 4 сетевые переменные 
  дрянь - прием команд от SCADA
    
```
Адрес прибора(slave): 16
Скорость Serial интерфейса: 115200
Список сетевых переменных:
512 - r1  ----красный  \
513 - y1  ----жёлтый    |------ первый светофор
514 - g1  ----зеленый  /
515 - r2  ----красный  \
516 - y2  ----жёлтый    |------ второй светофор
517 - g2  ----зеленый  /
518 - SwitchMode - Смена режима управления
519 - SwitchControl - Смена *сигнала* управления (только в ручном режиме)
520 - Red_color_timing - Время работы красного сигнала светофоров (в целочисленном виде в *секундах*)
521 - Green_color_timing - Время работы зелёного сигнала светофоров (в целочисленном виде в *секундах*)
522 - Automatically - флаг состояния режима управления (ручной [1] или автоматический [0] по таймеру)
523 - TestLight - (зарезервирано) но поскольку на 201 есть лампочки, можно исползовать как индентификатов в массе других, похожих контроллеров по сигналу
524 - DisableLight - отключение логики перекрёстка (моргающий Жёлтый)
525 - DisableLightFlag - флаг указывающий на состояние логики перекрёстра
526 - LOCKS - Флаг запрета на действия с прибором (выставляется если сейчас на приборе происходит анимация, или переключение между режимами
```
все переменные передаются в целочисленном формате, на высокой стороне преобразубся в bool при необходимости
